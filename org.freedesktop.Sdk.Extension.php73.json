{
	"id": "org.freedesktop.Sdk.Extension.php73",
	"branch": "19.08",
	"runtime": "org.freedesktop.Sdk",
	"build-extension": true,
	"sdk": "org.freedesktop.Sdk",
	"runtime-version": "19.08",
	"sdk-extensions": [],
	"separate-locales": false,
	"appstream-compose": false,
	"cleanup": [
		"/share/info",
		"/share/man",
		"/include",
		"*.a",
		"*.la"
	],
	"build-options": {
		"no-debuginfo": true,
		"strip": true,
		"prefix": "/usr/lib/sdk/php73",
		"append-pkg-config-path": "/usr/lib/sdk/php73/lib/pkgconfig"
	},
	"modules": [
		{
			"name": "libldap",
			"buildsystem": "autotools",
			"config-opts": [
				"--disable-slapd",
				"--disable-static"
			],
			"sources": [
				{
					"type": "archive",
					"url": "https://www.openldap.org/software/download/OpenLDAP/openldap-release/openldap-2.4.48.tgz",
					"sha256": "d9523ffcab5cd14b709fcf3cb4d04e8bc76bb8970113255f372bc74954c6074d"
				},
				{
					"type": "patch",
					"path": "openldap-aarch64.patch",
                    "only-arches": [
						"aarch64"
					]
				}
			],
			"post-install": [
				"install -Dm644 LICENSE ${FLATPAK_DEST}/share/licenses/libldap/LICENSE"
			]
		},
		{
			"name": "libpq",
			"buildsystem": "simple",
			"build-commands": [
				"./configure --prefix=/usr/lib/sdk/php73 --disable-rpath --with-openssl --without-readline",
				"cd src/interfaces/libpq",
				"make",
				"make install"
			],
			"sources":[
				{
					"type": "archive",
					"url": "https://ftp.postgresql.org/pub/source/v12.0/postgresql-12.0.tar.bz2",
					"sha256": "cda2397215f758b793f741c86be05468257b0e6bcb1a6113882ab5d0df0855c6"
				}
			],
			"post-install": [
				"install -Dm644 COPYRIGHT ${FLATPAK_DEST}/share/licenses/libpq/LICENSE"
			]
		},
		{
			"name": "libzip",
			"buildsystem": "cmake-ninja",
			"config-opts": [
				"-DBUILD_TOOLS=OFF",
				"-DBUILD_EXAMPLES=OFF",
				"-DBUILD_DOC=OFF"
			],
			"sources": [
				{
					"type": "archive",
					"url": "https://libzip.org/download/libzip-1.5.2.tar.gz",
					"sha256": "be694a4abb2ffe5ec02074146757c8b56084dbcebf329123c84b205417435e15"
				}
			],
			"post-install": [
				"install -Dm644 LICENSE ${FLATPAK_DEST}/share/licenses/libzip/LICENSE"
			]
		},
		{
			"name": "libsodium",
			"buildsystem": "autotools",
			"sources": [
				{
					"type": "git",
					"url": "https://github.com/jedisct1/libsodium.git",
					"branch": "stable",
					"commit": "bfa866e2f043b9b1c52c3e777e76f4f743d78352"
				}
			],
			"post-install": [
				"install -Dm644 LICENSE ${FLATPAK_DEST}/share/licenses/libsodium/LICENSE"
			]
		},
		{
			"name": "libargon2",
			"buildsystem": "simple",
			"build-commands": [
				"PREFIX=/usr/lib/sdk/php73 LIBRARY_REL=lib make",
				"PREFIX=/usr/lib/sdk/php73 LIBRARY_REL=lib make install"
			],
			"sources": [
				{
					"type": "git",
					"url": "https://github.com/P-H-C/phc-winner-argon2.git",
					"tag": "20190702",
					"commit": "62358ba2123abd17fccf2a108a301d4b52c01a7c"
				}
			],
			"post-install": [
				"install -Dm644 LICENSE ${FLATPAK_DEST}/share/licenses/libargon2/LICENSE"
			]
		},
		{
			"name": "php",
			"buildsystem": "autotools",
			"config-opts": [
				"--enable-option-checking=fatal",
				"--mandir=${FLATPAK_DEST}/share/man",
				"--with-config-file-scan-dir=${FLATPAK_DEST}/etc/php:/app/etc/php:/var/config/php/7.3/ini",
				"--disable-cgi",
				"--enable-bcmath",
				"--enable-calendar",
				"--enable-dba=shared",
				"--enable-exif",
				"--enable-ftp",
				"--enable-intl",
				"--enable-mbstring",
				"--enable-opcache",
				"--enable-pcntl",
				"--enable-phpdbg",
				"--enable-re2c-cgoto",
				"--enable-sockets",
				"--enable-sysvmsg",
				"--enable-sysvsem",
				"--enable-sysvshm",
				"--enable-wddx",
				"--enable-zip",
				"--with-bz2",
				"--with-curl",
				/*"--with-enchant",*/
				"--with-gd",
				"--with-jpeg-dir=/usr",
				"--with-png-dir=/usr",
				"--with-xpm-dir=/usr",
				"--with-webp-dir=/usr",
				"--with-freetype-dir=/usr",
				"--with-gettext",
				/*"--with-gmp",*/
				/*"--with-imap",*/
				"--with-ldap=/usr/lib/sdk/php73",
				"--with-libzip",
				"--with-mhash",
				"--with-mysqli",
				"--with-openssl",
				"--with-password-argon2=/usr/lib/sdk/php73",
				"--with-pdo-mysql",
				"--with-pdo-pgsql=/usr/lib/sdk/php73",
				"--with-pdo-sqlite=/usr",
				"--with-pspell",
				"--with-readline",
				/*"--with-recode",*/
				/*"--with-snmp",*/
				"--with-sodium",
				"--with-sqlite3=/usr",
				/*"--with-tidy",*/
				"--with-xmlrpc",
				"--with-xsl",
				"--with-zlib"
			],
			"post-install": [
				"install -Dm644 php.ini-development ${FLATPAK_DEST}/lib/php.ini",
				"install -Dm644 LICENSE ${FLATPAK_DEST}/share/licenses/php/LICENSE"
			],
			"sources": [
				{
					"type": "archive",
					"url": "https://www.php.net/distributions/php-7.3.11.tar.xz",
					"sha256": "657cf6464bac28e9490c59c07a2cf7bb76c200f09cfadf6e44ea64e95fa01021"
				}
			]
		},
		{
			"name":"xdebug",
			"buildsystem":"autotools",
			"config-opts": [
				"--with-php-config=/usr/lib/sdk/php73/bin/php-config"
			],
			"post-install": [
				"install -Dm755 modules/xdebug.so ${FLATPAK_DEST}/lib/php/extensions/no-debug-non-zts-20180731/xdebug.so",
				"install -Dm644 xdebug.ini ${FLATPAK_DEST}/etc/php/xdebug.ini",
				"install -Dm644 LICENSE ${FLATPAK_DEST}/share/licenses/xdebug/LICENSE"
			],
			"sources":[
				{
					"type":"archive",
					"url":"https://xdebug.org/files/xdebug-2.8.0.tgz",
					"sha256":"cb1d117ecbec7409a408cf24e59d92f7e3816fe8e2331dd0ffc3dce60228c264"
				},
				{
					"type":"file",
					"path":"xdebug.ini"
				},
				{
					"type": "shell",
					"commands": [
						"${FLATPAK_DEST}/bin/phpize"
					]
				}
			]
		},
		{
			"name": "composer",
			"buildsystem": "simple",
			"build-commands": [
				"install -Dm755 composer.phar ${FLATPAK_DEST}/bin/composer",
				"install -Dm644 LICENSE ${FLATPAK_DEST}/share/licenses/composer/LICENSE"
			],
			"sources": [
				{
					"type": "file",
					"url": "https://getcomposer.org/download/1.9.1/composer.phar",
					"sha256": "1f210b9037fcf82670d75892dfc44400f13fe9ada7af9e787f93e50e3b764111"
				},
				{
					"type": "git",
					"url": "https://github.com/composer/composer.git",
					"tag": "1.9.1",
					"commit": "bb01f2180df87ce7992b8331a68904f80439dd2f"
				}
			]
		},
		{
 			"name": "appdata",
		        "buildsystem": "simple",
		        "build-commands": [
                		"mkdir -p ${FLATPAK_DEST}/share/appdata",
		                "cp org.freedesktop.Sdk.Extension.php73.appdata.xml ${FLATPAK_DEST}/share/appdata",
		                "appstream-compose --basename=org.freedesktop.Sdk.Extension.php73 --prefix=${FLATPAK_DEST} --origin=flatpak org.freedesktop.Sdk.Extension.php73"
		        ],
		        "sources": [
		                {
                			"type": "file",
			                "path": "org.freedesktop.Sdk.Extension.php73.appdata.xml"
		                }
		        ]
		},
		{
			"name":"scripts",
			"buildsystem":"simple",
			"build-commands":[
				"install -Dm755 enable.sh ${FLATPAK_DEST}/enable.sh"
			],
			"sources":[
				{
				    "type":"script",
				    "commands":[
				        "export PATH=$PATH:/usr/lib/sdk/php73/bin"
				    ],
				    "dest-filename":"enable.sh"
				}
			]
		}
	]
}
